{% extends "base.html" %}

{% block title %}{{ product.title }} - EcoFinds{% endblock %}

{% block content %}
<div class="product-detail-container">
    <div class="card" style="padding: 2rem; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.05);">
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; align-items: start;">
            
            <!-- Product Image -->
            <div class="product-image-section">
                <div style="width: 100%; height: 400px; background: linear-gradient(135deg, #f0f0f0, #e0e0e0); border-radius: 15px; display: flex; align-items: center; justify-content: center; overflow: hidden;">
                    {% if product.image %}
                        <img src="{{ url_for('static', filename='uploads/' ~ product.image) }}" 
                             alt="{{ product.title }}" 
                             style="width: 100%; height: 100%; object-fit: cover; display: block;"
                             onerror="this.src='{{ url_for('static', filename='uploads/default.png') }}';">
                    {% else %}
                        <i class="fas fa-image" style="font-size: 4rem; color: #999;"></i>
                    {% endif %}
                </div>
            </div>

            <!-- Product Information -->
            <div class="product-info-section">
                {% if product.category %}
                    <span class="product-category" style="color: #4CAF50; font-weight: 600;">{{ product.category }}</span>
                {% endif %}
                
                <h1 style="color: #2d5a27; margin: 1rem 0; font-size: 2rem;">{{ product.title }}</h1>
                
                <div style="font-size: 2rem; font-weight: bold; color: #4CAF50; margin-bottom: 2rem;">
                    ${{ "%.2f"|format(product.price) }}
                </div>

                {% if product.description %}
                    <div style="margin-bottom: 2rem;">
                        <h3 style="color: #333; margin-bottom: 0.5rem;">Description</h3>
                        <p style="color: #666; line-height: 1.6;">{{ product.description }}</p>
                    </div>
                {% endif %}

                <div style="margin-bottom: 2rem; padding: 1rem; background: rgba(76, 175, 80, 0.05); border-radius: 10px;">
                    <h4 style="color: #2d5a27; margin-bottom: 0.5rem;">
                        <i class="fas fa-user"></i> Seller Information
                    </h4>
                    <p style="color: #666;">Listed by: <strong>{{ product.owner.username }}</strong></p>
                    <p style="color: #666; font-size: 0.9rem;">
                        <i class="fas fa-calendar"></i> Listed on {{ product.created_at.strftime('%B %d, %Y') }}
                    </p>
                </div>

                <!-- Action Buttons -->
                <div class="action-buttons">
                    {% if session.user_id %}
                        {% if session.user_id == product.user_id %}
                            <!-- Owner Actions -->
                            <div class="d-flex gap-2 mb-2" style="display: flex; gap: 0.5rem;">
                                <a href="{{ url_for('edit_product', product_id=product.id) }}" class="btn btn-primary" style="flex: 1;">
                                    <i class="fas fa-edit"></i> Edit Product
                                </a>
                                <a href="{{ url_for('delete_product', product_id=product.id) }}" 
                                   class="btn btn-danger"
                                   onclick="return confirm('Are you sure you want to delete this product?')" style="flex: 1;">
                                    <i class="fas fa-trash"></i> Delete
                                </a>
                            </div>
                        {% else %}
                            <!-- Buyer Actions -->
                            <div class="d-flex gap-2 mb-2" style="display: flex; gap: 0.5rem;">
                                <a href="{{ url_for('add_to_cart', user_id=session.user_id, product_id=product.id) }}" 
                                   class="btn btn-primary" style="flex: 1;">
                                    <i class="fas fa-cart-plus"></i> Add to Cart
                                </a>
                                <a href="{{ url_for('purchase', user_id=session.user_id, product_id=product.id) }}" 
                                   class="btn btn-outline"
                                   onclick="return confirm('Are you sure you want to purchase this item?')" style="flex: 1;">
                                    <i class="fas fa-shopping-bag"></i> Buy Now
                                </a>
                            </div>
                        {% endif %}
                    {% else %}
                        <div class="text-center" style="padding: 2rem; background: rgba(76, 175, 80, 0.05); border-radius: 10px;">
                            <p style="color: #666; margin-bottom: 1rem;">Please log in to purchase this item</p>
                            <a href="{{ url_for('login') }}" class="btn btn-primary">
                                <i class="fas fa-sign-in-alt"></i> Login to Buy
                            </a>
                        </div>
                    {% endif %}
                </div>

                <div class="mt-2">
                    <a href="{{ url_for('home') }}" class="btn btn-secondary">
                        <i class="fas fa-arrow-left"></i> Back to Products
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Sustainability Message -->
    <div class="card mt-3" style="background: rgba(76, 175, 80, 0.05); text-align: center; padding: 1.5rem; border-radius: 12px;">
        <i class="fas fa-leaf" style="font-size: 2rem; color: #4CAF50; margin-bottom: 1rem;"></i>
        <h3 style="color: #2d5a27; margin-bottom: 1rem;">ðŸŒ± Sustainable Choice</h3>
        <p style="color: #666; max-width: 600px; margin: 0 auto;">
            By choosing second-hand, you're helping reduce waste and giving products a new life. 
            Every purchase makes a difference for our planet!
        </p>
    </div>
</div>

<style>
    @media (max-width: 768px) {
        .product-detail-container .card > div {
            grid-template-columns: 1fr !important;
            gap: 2rem !important;
        }
        .product-info-section h1 {
            font-size: 1.5rem;
        }
        .product-info-section div[style*="font-size: 2rem"] {
            font-size: 1.5rem !important;
        }
    }
</style>
{% endblock %}
